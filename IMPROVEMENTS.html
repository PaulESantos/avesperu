<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Mejoras Implementadas - Paquete avesperu â€¢ avesperu</title><script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Jost-0.4.10/font.css" rel="stylesheet"><link href="deps/Overpass_Mono-0.4.10/font.css" rel="stylesheet"><link href="deps/Abhaya_Libre-0.4.10/font.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Mejoras Implementadas - Paquete avesperu"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">avesperu</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/PaulESantos/avesperu/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-title-body">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Mejoras Implementadas - Paquete avesperu</h1>
      <small class="dont-index">Source: <a href="https://github.com/PaulESantos/avesperu/blob/master/IMPROVEMENTS.md" class="external-link"><code>IMPROVEMENTS.md</code></a></small>
    </div>

<div id="mejoras-implementadas---paquete-avesperu" class="section level1">

<p>Documento que resume las mejoras implementadas en la suite de tests siguiendo las mejores prÃ¡cticas de testthat 3+ y la skill <code>revicion-r-packages</code>.</p>
<div class="section level2">
<h2 id="id_-cambios-realizados">ğŸ“‹ Cambios Realizados<a class="anchor" aria-label="anchor" href="#id_-cambios-realizados"></a></h2>
<div class="section level3">
<h3 id="id_1-reorganizaciÃ³n-de-archivos-de-tests">1. ReorganizaciÃ³n de Archivos de Tests<a class="anchor" aria-label="anchor" href="#id_1-reorganizaci%C3%B3n-de-archivos-de-tests"></a></h3>
<div class="section level4">
<h4 id="antes">Antes:<a class="anchor" aria-label="anchor" href="#antes"></a></h4>
<pre><code>tests/testthat/
â””â”€â”€ test-test_search_avesperu.R  âŒ Nombre redundante</code></pre>
</div>
<div class="section level4">
<h4 id="despuÃ©s">DespuÃ©s:<a class="anchor" aria-label="anchor" href="#despu%C3%A9s"></a></h4>
<pre><code>tests/testthat/
â”œâ”€â”€ test-search-avesperu.R           âœ… FunciÃ³n principal (renombrado)
â”œâ”€â”€ test-standardize-names.R         âœ… NUEVO - Tests para standardize_names()
â”œâ”€â”€ test-find-duplicates.R           âœ… NUEVO - Tests para find_duplicates()
â”œâ”€â”€ test-result-creators.R           âœ… NUEVO - Tests para create_*_result()
â”œâ”€â”€ test-parallel-processing.R       âœ… NUEVO - Tests para procesamiento paralelo
â”œâ”€â”€ helper-expectations.R             âœ… NUEVO - Expectativas personalizadas
â””â”€â”€ testthat.R                       (Sin cambios)</code></pre>
</div>
</div>
<div class="section level3">
<h3 id="id_2-sintaxis-bdd-behavior-driven-development">2. Sintaxis BDD (Behavior-Driven Development)<a class="anchor" aria-label="anchor" href="#id_2-sintaxis-bdd-behavior-driven-development"></a></h3>
<p>Se implementÃ³ sintaxis <code>describe()/it()</code> en lugar de solo <code>test_that()</code>:</p>
<p><strong>Antes:</strong></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">test_that</span><span class="op">(</span><span class="st">"search_avesperu behaves as expected"</span>, <span class="op">{</span></span>
<span>  <span class="co"># MÃºltiples escenarios mezclados</span></span>
<span>  <span class="co"># DifÃ­cil de leer y mantener</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
<p><strong>DespuÃ©s:</strong></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">describe</span><span class="op">(</span><span class="st">"search_avesperu()"</span>, <span class="op">{</span></span>
<span>  <span class="fu">it</span><span class="op">(</span><span class="st">"finds exact matches correctly"</span>, <span class="op">{</span></span>
<span>    <span class="co"># Comportamiento especÃ­fico</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu">it</span><span class="op">(</span><span class="st">"handles empty input correctly"</span>, <span class="op">{</span></span>
<span>    <span class="co"># Comportamiento especÃ­fico</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_3-cobertura-de-funciones-internas">3. Cobertura de Funciones Internas<a class="anchor" aria-label="anchor" href="#id_3-cobertura-de-funciones-internas"></a></h3>
<p>Se crearon tests dedicados para:</p>
<div class="section level4">
<h4 id="test-standardize-namesr-19-tests">
<code>test-standardize-names.R</code> (19 tests)<a class="anchor" aria-label="anchor" href="#test-standardize-namesr-19-tests"></a></h4>
<ul><li>Trimming de espacios</li>
<li>CapitalizaciÃ³n del gÃ©nero</li>
<li>MinÃºsculas de especies</li>
<li>Manejo de abreviaciones (cf., aff.)</li>
<li>DetecciÃ³n de hÃ­bridos (x)</li>
<li>NormalizaciÃ³n de espacios mÃºltiples</li>
<li>Manejo de NA y strings vacÃ­os</li>
</ul></div>
<div class="section level4">
<h4 id="test-find-duplicatesr-11-tests">
<code>test-find-duplicates.R</code> (11 tests)<a class="anchor" aria-label="anchor" href="#test-find-duplicatesr-11-tests"></a></h4>
<ul><li>DetecciÃ³n de duplicados exactos</li>
<li>MÃºltiples duplicados</li>
<li>Casos sin duplicados</li>
<li>Input vacÃ­o y single element</li>
<li>Case sensitivity</li>
<li>Manejo de NA</li>
</ul></div>
<div class="section level4">
<h4 id="test-result-creatorsr-18-tests">
<code>test-result-creators.R</code> (18 tests)<a class="anchor" aria-label="anchor" href="#test-result-creatorsr-18-tests"></a></h4>
<ul><li>
<strong>create_empty_result()</strong>: Estructura correcta, valores NA</li>
<li>
<strong>create_match_result()</strong>: Mapeo de datos, conversiÃ³n de distancia</li>
</ul></div>
</div>
<div class="section level3">
<h3 id="id_4-expectativas-personalizadas-helper-expectationsr">4. Expectativas Personalizadas (helper-expectations.R)<a class="anchor" aria-label="anchor" href="#id_4-expectativas-personalizadas-helper-expectationsr"></a></h3>
<p>Se crearon funciones de expectaciÃ³n reutilizables:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">expect_valid_search_result</span><span class="op">(</span><span class="va">result</span><span class="op">)</span>        <span class="co"># Valida estructura completa</span></span>
<span><span class="fu">expect_matched_species</span><span class="op">(</span><span class="va">result</span>, <span class="va">name</span><span class="op">)</span>      <span class="co"># Valida match exitoso</span></span>
<span><span class="fu">expect_unmatched_species</span><span class="op">(</span><span class="va">result</span><span class="op">)</span>          <span class="co"># Valida no-match</span></span>
<span><span class="fu">expect_standardized_name</span><span class="op">(</span><span class="va">name</span><span class="op">)</span>            <span class="co"># Valida formato estÃ¡ndar</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="id_5-tests-para-edge-cases">5. Tests para Edge Cases<a class="anchor" aria-label="anchor" href="#id_5-tests-para-edge-cases"></a></h3>
<p>Se agregaron tests para:</p>
<ul><li>âœ… Entrada vacÃ­a: <code>character(0)</code>
</li>
<li>âœ… Valores NA en la lista</li>
<li>âœ… Strings vacÃ­os</li>
<li>âœ… ParÃ¡metro <code>batch_size</code>
</li>
<li>âœ… ParÃ¡metro <code>max_distance</code> (validaciÃ³n)</li>
<li>âœ… Factor como entrada</li>
<li>âœ… DetecciÃ³n de duplicados en input</li>
<li>âœ… Estructura de salida correcta</li>
</ul></div>
<div class="section level3">
<h3 id="id_6-tests-para-procesamiento-paralelo">6. Tests para Procesamiento Paralelo<a class="anchor" aria-label="anchor" href="#id_6-tests-para-procesamiento-paralelo"></a></h3>
<p>Se agregaron 10 tests para:</p>
<ul><li>âœ… Consistencia entre procesamiento secuencial y paralelo</li>
<li>âœ… Respeto del parÃ¡metro <code>batch_size</code>
</li>
<li>âœ… Manejo de <code>n_cores = NULL</code> (auto-detect)</li>
<li>âœ… ValidaciÃ³n de parÃ¡metros (<code>parallel</code>, <code>n_cores</code>)</li>
<li>âœ… DeshabilitaciÃ³n automÃ¡tica para listas pequeÃ±as</li>
<li>âœ… Orden de resultados en procesamiento paralelo</li>
</ul></div>
</div>
<div class="section level2">
<h2 id="id_-estadÃ­sticas">ğŸ“Š EstadÃ­sticas<a class="anchor" aria-label="anchor" href="#id_-estad%C3%ADsticas"></a></h2>
<table class="table"><thead><tr class="header"><th>MÃ©trica</th>
<th>Antes</th>
<th>DespuÃ©s</th>
<th>Cambio</th>
</tr></thead><tbody><tr class="odd"><td>Archivos de test</td>
<td>1</td>
<td>6</td>
<td>+5 archivos</td>
</tr><tr class="even"><td>Tests totales</td>
<td>~15</td>
<td>~80+</td>
<td>+65 tests</td>
</tr><tr class="odd"><td>Cobertura de funciones internas</td>
<td>Parcial</td>
<td>Completa</td>
<td>âœ…</td>
</tr><tr class="even"><td>Sintaxis BDD</td>
<td>No</td>
<td>SÃ­</td>
<td>âœ…</td>
</tr><tr class="odd"><td>Expectativas personalizadas</td>
<td>No</td>
<td>4</td>
<td>âœ…</td>
</tr><tr class="even"><td>Tests de edge cases</td>
<td>Parcial</td>
<td>Completo</td>
<td>âœ…</td>
</tr></tbody></table></div>
<div class="section level2">
<h2 id="id_-mejoras-alineadas-con-testthat-3">ğŸ¯ Mejoras Alineadas con testthat 3<a class="anchor" aria-label="anchor" href="#id_-mejoras-alineadas-con-testthat-3"></a></h2>
<div class="section level3">
<h3 id="id_-implementado">âœ… Implementado<a class="anchor" aria-label="anchor" href="#id_-implementado"></a></h3>
<ol style="list-style-type: decimal"><li>
<strong>File Organization</strong>: Archivos organizados por funciÃ³n/componente</li>
<li>
<strong>BDD Syntax</strong>: Uso de <code>describe()/it()</code> en test-search-avesperu.R</li>
<li>
<strong>Self-Sufficient Tests</strong>: Cada test contiene sus propios datos</li>
<li>
<strong>Custom Expectations</strong>: Helper file con expectativas personalizadas</li>
<li>
<strong>Edge Case Coverage</strong>: Tests para entradas vacÃ­as, NA, strings vacÃ­os</li>
<li>
<strong>Helper Functions</strong>: Funciones internas cuentan con cobertura dedicada</li>
<li>
<strong>Batch Processing Tests</strong>: ValidaciÃ³n de parÃ¡metros y comportamiento paralelo</li>
</ol></div>
<div class="section level3">
<h3 id="id_-configuraciÃ³n-existente-">ğŸ“ ConfiguraciÃ³n Existente âœ…<a class="anchor" aria-label="anchor" href="#id_-configuraci%C3%B3n-existente-"></a></h3>
<ul><li>
<code>Config/testthat/edition: 3</code> en DESCRIPTION</li>
<li>
<code>tests/testthat.R</code> correctamente configurado</li>
<li>
<code>testthat (&gt;= 3.0.0)</code> en Suggests</li>
</ul></div>
</div>
<div class="section level2">
<h2 id="id_-prÃ³ximas-mejoras-opcionales">ğŸ”„ PrÃ³ximas Mejoras Opcionales<a class="anchor" aria-label="anchor" href="#id_-pr%C3%B3ximas-mejoras-opcionales"></a></h2>
<ol style="list-style-type: decimal"><li>
<strong>Mocking de dependencias externas</strong>
<ul><li>Mockear <code><a href="http://xml2.r-lib.org/reference/read_xml.html" class="external-link">xml2::read_html()</a></code> en <code><a href="reference/unop_check_update.html">unop_check_update()</a></code>
</li>
<li>Usar <code>local_mocked_bindings()</code>
</li>
</ul></li>
<li>
<strong>Snapshot Testing</strong>
<ul><li>Para mensajes de error complejos</li>
<li>Para salida formateada de resultados</li>
</ul></li>
<li>
<strong>Test Fixtures</strong>
<ul><li>Crear <code>tests/testthat/fixtures/</code>
</li>
<li>Almacenar datos de prueba reutilizables</li>
</ul></li>
<li>
<strong>Performance Tests</strong>
<ul><li>Medir tiempo de ejecuciÃ³n con listas grandes</li>
<li>Usar <code>devtools::test(reporter = "slow")</code>
</li>
</ul></li>
</ol></div>
<div class="section level2">
<h2 id="id_-referencias">ğŸ“š Referencias<a class="anchor" aria-label="anchor" href="#id_-referencias"></a></h2>
<ul><li><a href="https://testthat.r-lib.org/" class="external-link">testthat 3 Guide</a></li>
<li><a href="https://r-pkgs.org/testing-design.html" class="external-link">R Packages Book - Testing</a></li>
<li><a href="https://style.tidyverse.org/" class="external-link">tidyverse style guide</a></li>
</ul></div>
<div class="section level2">
<h2 id="id_-resumen">âœ¨ Resumen<a class="anchor" aria-label="anchor" href="#id_-resumen"></a></h2>
<p>El paquete <code>avesperu</code> ahora cuenta con una <strong>suite de tests moderna y completa</strong> que sigue las mejores prÃ¡cticas de testthat 3+. La cobertura se ha expandido significativamente, con enfoque en:</p>
<ul><li>Funciones internas completamente testeadas</li>
<li>Sintaxis legible con BDD</li>
<li>Manejo exhaustivo de edge cases</li>
<li>Expectativas reutilizables y claras</li>
<li>Tests para procesamiento paralelo y en lotes</li>
</ul><p>Esto mejora la <strong>calidad, mantenibilidad y confiabilidad</strong> del cÃ³digo.</p>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul E. Santos Andrade.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

