<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Search for Bird Species Data in the Birds of Peru Dataset — search_avesperu • avesperu</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Jost-0.4.10/font.css" rel="stylesheet"><link href="../deps/Overpass_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Abhaya_Libre-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Search for Bird Species Data in the Birds of Peru Dataset — search_avesperu"><meta name="description" content="This function searches for bird species information in the dataset provided by
the avesperu package, given a list of species names. It supports approximate
(fuzzy) matching to handle typographical errors or minor variations in species
names using optimized agrep() matching. The function is optimized for both
small and large lists through intelligent pre-filtering and optional parallel
processing, while maintaining exact agrep() precision."><meta property="og:description" content="This function searches for bird species information in the dataset provided by
the avesperu package, given a list of species names. It supports approximate
(fuzzy) matching to handle typographical errors or minor variations in species
names using optimized agrep() matching. The function is optimized for both
small and large lists through intelligent pre-filtering and optional parallel
processing, while maintaining exact agrep() precision."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">avesperu</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.0.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/PaulESantos/avesperu/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Search for Bird Species Data in the Birds of Peru Dataset</h1>
      <small class="dont-index">Source: <a href="https://github.com/PaulESantos/avesperu/blob/master/R/get_avesperu.R" class="external-link"><code>R/get_avesperu.R</code></a></small>
      <div class="d-none name"><code>search_avesperu.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function searches for bird species information in the dataset provided by
the <code>avesperu</code> package, given a list of species names. It supports approximate
(fuzzy) matching to handle typographical errors or minor variations in species
names using optimized <code><a href="https://rdrr.io/r/base/agrep.html" class="external-link">agrep()</a></code> matching. The function is optimized for both
small and large lists through intelligent pre-filtering and optional parallel
processing, while maintaining exact <code><a href="https://rdrr.io/r/base/agrep.html" class="external-link">agrep()</a></code> precision.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">search_avesperu</span><span class="op">(</span></span>
<span>  <span class="va">splist</span>,</span>
<span>  max_distance <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  return_details <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  batch_size <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-splist">splist<a class="anchor" aria-label="anchor" href="#arg-splist"></a></dt>
<dd><p>A character vector or factor containing the scientific names of
bird species to search for. Names can include minor variations or typos.</p></dd>


<dt id="arg-max-distance">max_distance<a class="anchor" aria-label="anchor" href="#arg-max-distance"></a></dt>
<dd><p>Numeric. The maximum allowable distance for fuzzy matching.
Can be either:</p><ul><li><p>A proportion between 0 and 1 (e.g., 0.1 = 10\<!-- % of string length) --></p></li>
<li><p>An integer representing the maximum number of character differences</p></li>
</ul><p>Default: 0.1.</p></dd>


<dt id="arg-return-details">return_details<a class="anchor" aria-label="anchor" href="#arg-return-details"></a></dt>
<dd><p>Logical. If <code>FALSE</code> (default), returns only a character
vector of species status. If <code>TRUE</code>, returns a detailed data frame with
complete reconciliation information including taxonomic data and matching distances.</p></dd>


<dt id="arg-batch-size">batch_size<a class="anchor" aria-label="anchor" href="#arg-batch-size"></a></dt>
<dd><p>Integer. Number of species to process per batch when handling
large lists. Useful for memory management and progress tracking.
Default: 100 species per batch.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Logical. Should parallel processing be used for large lists?
Automatically disabled for small lists. Requires the <code>parallel</code> package.
Default: <code>TRUE</code>.</p></dd>


<dt id="arg-n-cores">n_cores<a class="anchor" aria-label="anchor" href="#arg-n-cores"></a></dt>
<dd><p>Integer or <code>NULL</code>. Number of CPU cores to use for parallel
processing. If <code>NULL</code> (default), uses <code>detectCores() - 1</code> to leave
one core free for system operations.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The return value depends on the <code>return_details</code> parameter:</p>
<p><strong>If return_details = FALSE (default):</strong></p>
<p>A character vector with the same length as <code>splist</code>, containing the
conservation/occurrence status for each species. <code>NA</code> values indicate
no match was found.</p>
<p><strong>If return_details = TRUE:</strong></p>
<p>A data frame (tibble-compatible) with the following columns:</p><dl><dt>name_submitted</dt>
<dd><p>Character. The species name provided as input (standardized).</p></dd>

<dt>accepted_name</dt>
<dd><p>Character. The closest matching species name from the
database, or <code>NA</code> if no match found within <code>max_distance</code>.</p></dd>

<dt>order_name</dt>
<dd><p>Character. The taxonomic order of the matched species.</p></dd>

<dt>family_name</dt>
<dd><p>Character. The taxonomic family of the matched species.</p></dd>

<dt>english_name</dt>
<dd><p>Character. Common name in English.</p></dd>

<dt>spanish_name</dt>
<dd><p>Character. Common name in Spanish.</p></dd>

<dt>status</dt>
<dd><p>Character. Conservation or occurrence status (e.g., "Endemic",
"Resident", "Migrant", "Vagrant").</p></dd>

<dt>dist</dt>
<dd><p>Character. Edit distance between submitted and matched names.
Lower values indicate better matches. <code>NA</code> if no match found.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function performs the following steps:</p><ol><li><p>Validates input and converts factors to character vectors</p></li>
<li><p>Standardizes species names using <code><a href="standardize_names.html">standardize_names()</a></code></p></li>
<li><p>Identifies and reports duplicate entries in the input list</p></li>
<li><p>Uses intelligent pre-filtering to reduce search space:</p><ul><li><p>Filters by string length (mathematically guaranteed to preserve matches)</p></li>
<li><p>Optionally filters by first character for very large candidate sets</p></li>
</ul></li>
<li><p>Performs precise <code><a href="https://rdrr.io/r/base/agrep.html" class="external-link">agrep()</a></code> fuzzy matching on filtered candidates</p></li>
<li><p>Calculates exact edit distances using <code><a href="https://rdrr.io/r/utils/adist.html" class="external-link">adist()</a></code></p></li>
<li><p>Selects the best match (minimum distance) for each query</p></li>
<li><p>For large lists (&gt;batch_size), processes in batches with optional parallelization</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="warning">Warning<a class="anchor" aria-label="anchor" href="#warning"></a></h2>


<p>For very large lists (&gt;10,000 species) with parallel processing enabled,
ensure sufficient system memory is available. Each parallel worker maintains
a copy of the reference database (~5-10 MB).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/base/agrep.html" class="external-link">agrep</a></code> for the underlying fuzzy matching algorithm</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Basic usage - returns status vector</span></span></span>
<span class="r-in"><span><span class="va">splist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Falco sparverius"</span>, <span class="st">"Tinamus osgodi"</span>, <span class="st">"Crypturellus soui"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">status</span> <span class="op">&lt;-</span> <span class="fu">search_avesperu</span><span class="op">(</span><span class="va">splist</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">status</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get detailed reconciliation information</span></span></span>
<span class="r-in"><span><span class="va">details</span> <span class="op">&lt;-</span> <span class="fu">search_avesperu</span><span class="op">(</span><span class="va">splist</span>, return_details <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">details</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Exact matching only (no fuzzy matching)</span></span></span>
<span class="r-in"><span><span class="va">exact_results</span> <span class="op">&lt;-</span> <span class="fu">search_avesperu</span><span class="op">(</span><span class="va">splist</span>, max_distance <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Handle species with typos</span></span></span>
<span class="r-in"><span><span class="va">typo_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Falco sparveruis"</span>, <span class="st">"Tinamus osgoodi"</span>, <span class="st">"Crypturellus sui"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">corrected</span> <span class="op">&lt;-</span> <span class="fu">search_avesperu</span><span class="op">(</span><span class="va">typo_list</span>, return_details <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># View submitted vs accepted names</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">corrected</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"name_submitted"</span>, <span class="st">"accepted_name"</span>, <span class="st">"dist"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Paul E. Santos Andrade.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

